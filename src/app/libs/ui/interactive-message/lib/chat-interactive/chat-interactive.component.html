<ng-container *ngIf="formattedMessage?.interactive?.type === 'list'">
    <p
        *ngIf="formattedMessage?.interactive?.header?.text; else mediaPreview"
        [innerHTML]="
            formattedMessage.interactive?.header?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="mat-body-2 text-dark fw-bold input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.body?.text"
        [innerHTML]="
            formattedMessage?.interactive?.body?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-14 text-dark input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.footer?.text"
        [innerHTML]="
            formattedMessage.interactive?.footer?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-10 text-light input-msg-break word-break"
    ></p>

    <ng-container *ngFor="let section of formattedMessage?.interactive?.action?.sections">
        <strong class="font-14">{{ section?.title }}</strong>
        <msg91-bot-options
            [disableAction]="disableAction"
            [options]="section.rows"
            (optionClick)="optionSelected.emit($event)"
        ></msg91-bot-options>
    </ng-container>
</ng-container>
<ng-container *ngIf="formattedMessage?.interactive?.type === 'button'">
    <!-- TODO(interactive): Add support of media -->
    <p
        *ngIf="formattedMessage?.interactive?.header?.text; else mediaPreview"
        [innerHTML]="
            formattedMessage.interactive?.header?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="mat-body-2 text-dark fw-bold input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.body?.text"
        [innerHTML]="
            formattedMessage?.interactive?.body?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-14 text-dark input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.footer?.text"
        [innerHTML]="
            formattedMessage.interactive?.footer?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-10 text-light input-msg-break word-break"
    ></p>

    <msg91-bot-options
        [disableAction]="disableAction"
        [options]="formattedMessage?.interactive?.action?.buttons"
        (optionClick)="optionSelected.emit($event)"
    ></msg91-bot-options>
</ng-container>

<ng-container *ngIf="formattedMessage?.interactive?.type === 'cta_url'">
    <p
        *ngIf="formattedMessage?.interactive?.header?.text; else mediaPreview"
        [innerHTML]="
            formattedMessage.interactive?.header?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="mat-body-2 text-dark fw-bold input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.body?.text"
        [innerHTML]="
            formattedMessage.interactive?.body?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="mat-body-2 mt-0 mb-1 input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.footer?.text"
        [innerHTML]="
            formattedMessage.interactive?.footer?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-10 text-light input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.action?.button"
        [innerHTML]="
            formattedMessage.interactive?.action?.button | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-12 mt-0 mb-1 input-msg-break word-break"
    ></p>
    <!-- <p
        *ngIf="formattedMessage?.interactive?.action?.name"
        [innerHTML]="
            formattedMessage.interactive?.action?.name | replace: '\n':'</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-12 mt-0 mb-2 input-msg-break word-break"
    ></p> -->
    <a [href]="formattedMessage?.interactive?.action?.parameters?.url" target="_blank">
        <button mat-flat-button class="flat-default mat-btn-md">
            <!-- {{ formattedMessage?.interactive?.action?.parameters?.display_text | whatsAppInlineStyleFormat}} -->
            <span
                [innerHTML]="
                    formattedMessage?.interactive?.action?.parameters?.display_text
                        | replace: '\n' : '</br>'
                        | whatsAppInlineStyleFormat
                        | linkify
                "
            ></span>
        </button>
    </a>
</ng-container>
<ng-container *ngIf="formattedMessage?.interactive?.type === 'product_list'">
    <p
        *ngIf="formattedMessage?.interactive?.header"
        [innerHTML]="
            formattedMessage.interactive?.header?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="mat-body-2 text-dark fw-bold input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.body?.text"
        [innerHTML]="
            formattedMessage?.interactive?.body?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-14 text-dark input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.footer?.text"
        [innerHTML]="
            formattedMessage.interactive?.footer?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-10 text-light input-msg-break word-break"
    ></p>
    <msg91-bot-options [disableAction]="disableAction" [options]="[{ name: 'View' }]"></msg91-bot-options>
</ng-container>
<ng-container *ngIf="formattedMessage?.interactive?.type === 'product'">
    <p
        *ngIf="formattedMessage?.interactive?.body?.text"
        [innerHTML]="
            formattedMessage?.interactive?.body?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-14 text-dark input-msg-break word-break"
    ></p>
    <p
        *ngIf="formattedMessage?.interactive?.footer?.text"
        [innerHTML]="
            formattedMessage.interactive?.footer?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify
        "
        class="font-10 text-light input-msg-break word-break"
    ></p>
    <msg91-bot-options [disableAction]="disableAction" [options]="[{ name: 'View' }]"></msg91-bot-options>
</ng-container>
<ng-container *ngIf="formattedMessage?.type === 'attachment' && formattedMessage?.attachment?.length">
    <ng-container [ngSwitch]="formattedMessage?.attachment[0]?.type">
        <ng-container *ngSwitchCase="'image'">
            <img [src]="formattedMessage?.attachment[0]?.path" loading="lazy" class="w-100" />
        </ng-container>
        <ng-container *ngSwitchCase="'video'">
            <video width="385" [src]="formattedMessage?.attachment[0]?.path" controls></video>
        </ng-container>
        <ng-container *ngSwitchCase="'audio'">
            <audio *ngIf="formattedMessage?.attachment[0]?.path" controls style="height: 44px">
                <source
                    [src]="formattedMessage?.attachment[0]?.path"
                    [type]="formattedMessage?.attachment[0]?.mime_type"
                />
            </audio>
        </ng-container>
        <ng-container *ngSwitchCase="'document'">
            <iframe
                *ngIf="formattedMessage?.attachment[0]?.extension === 'pdf'; else defaultDoc"
                width="100%"
                height="100%"
                scrolling="no"
                frameborder="0"
                [src]="formattedMessage?.attachment[0]?.path | safeURL"
            ></iframe>
            <ng-template #defaultDoc>
                <div class="card-media d-flex align-items-center justify-content-center">
                    <a href="javascript:;" (click)="downloadAttachment(formattedMessage?.attachment[0]?.path)"
                        ><mat-icon class="material-icons-outlined">text_snippet</mat-icon></a
                    >
                </div>
            </ng-template>
        </ng-container>
    </ng-container>
    <p
        *ngIf="formattedMessage?.text"
        [innerHTML]="formattedMessage?.text | replace: '\n' : '</br>' | whatsAppInlineStyleFormat | linkify"
        class="font-14 text-dark input-msg-break word-break"
    ></p>
</ng-container>
<ng-template #mediaPreview>
    <ng-container *ngIf="formattedMessage.interactive?.header as header">
        <ng-container *ngIf="header?.[header?.type]?.link as link">
            <ng-container [ngSwitch]="header?.type | uppercase">
                <ng-container *ngSwitchCase="templateHeaderFormat.Image">
                    <img [src]="link" loading="lazy" class="w-100" />
                </ng-container>
                <ng-container *ngSwitchCase="templateHeaderFormat.Video">
                    <video width="230" [src]="link" controls></video>
                </ng-container>
                <ng-container *ngSwitchCase="templateHeaderFormat.Document">
                    <iframe
                        *ngIf="header?.[header?.type]?.fileExtension === 'pdf'; else defaultDoc"
                        width="100%"
                        height="100%"
                        scrolling="no"
                        frameborder="0"
                        [src]="link | safeURL"
                    ></iframe>
                    <ng-template #defaultDoc>
                        <div class="card-media d-flex align-items-center justify-content-center">
                            <a href="javascript:;" (click)="downloadAttachment(link)"
                                ><mat-icon class="material-icons-outlined">text_snippet</mat-icon></a
                            >
                        </div>
                    </ng-template>
                </ng-container>
            </ng-container>
        </ng-container>
    </ng-container>
</ng-template>
