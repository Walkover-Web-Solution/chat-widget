<mat-form-field appearance="outline" class="no-padding" [ngClass]="matFormFieldClass?.length ? matFormFieldClass : ''">
    <mat-label>Select Service</mat-label>
    <mat-select
        matNativeControl
        msg91CloseDropdownOnEscape
        overlayPanelClass="testing"
        (selectionChange)="onSelectValue()"
        [(ngModel)]="selectedMicroServiceId"
        [multiple]="allowMultipleSelection"
        (openedChange)="checkSelectFieldsState.emit($event)"
    >
        <mat-option value="" *ngIf="!allowMultipleSelection"><span class="text-dark mat-body-1">All</span></mat-option>
        <mat-checkbox
            *ngIf="allowMultipleSelection"
            class="mat-option"
            [disableRipple]="true"
            [indeterminate]="
                selectedMicroServiceId.length > 0 && (microServiceType$ | async)?.length > selectedMicroServiceId.length
            "
            [checked]="(microServiceType$ | async)?.length === selectedMicroServiceId.length"
            (click)="$event.stopPropagation()"
            (change)="toggleSelectStatusAll($event)"
        >
            All
        </mat-checkbox>
        <ng-container *ngFor="let service of microServiceType$ | async">
            <mat-option [value]="service.id" *ngIf="filterMicroserviceId !== service.id">
                <div class="d-flex align-items-center">
                    <img
                        [src]="
                            'assets/images/microservice-icon/' +
                            (service.name | lowercase | split: ' ' | join: '') +
                            '.svg'
                        "
                        width="20"
                        height="20"
                        loading="lazy"
                        alt="Microservice icon"
                    />
                    <span class="mat-body-1 pl-2">{{ service.name }}</span>
                </div>
            </mat-option>
        </ng-container>
        <mat-select-trigger *ngIf="!allowMultipleSelection">
            <img
                *ngIf="selectedName !== 'All'"
                style="margin-bottom: -5px"
                [src]="imagePath"
                width="20"
                height="20"
                class="mr-2"
                loading="lazy"
                alt="Microservice icon"
            />
            <span>{{ selectedName }}</span>
        </mat-select-trigger>
    </mat-select>
</mat-form-field>
