<mat-form-field [appearance]="appearance" class="w-100">
    <mat-label *ngIf="labelFloat">Select {{ fieldName }} </mat-label>
    <input
        type="text"
        matInput
        [matAutocomplete]="matAutoComplete"
        #autoCompleteInput
        [formControl]="matFormControl"
        #trigger="matAutocompleteTrigger"
        [msg91CloseDropdownOnEscape]="trigger"
        [placeholder]="'Select ' + fieldName"
    />
    <mat-autocomplete
        #matAutoComplete="matAutocomplete"
        (optionSelected)="selectOption()"
        msg91AutoSelectDropdown
        (setControlValue)="setControlValue($event)"
        [displayWith]="displayFunction"
    >
        <mat-option *ngIf="showAddFeatureButton" (click)="addButtonEventTrigger.emit()" class="mt-2">
            <button mat-flat-button class="mat-btn-md flat-primary-light">
                <mat-icon class="mat-icon-prefix mr-0 mat-icon-18">add</mat-icon>
                {{ featureButtonContent }}
            </button>
        </mat-option>
        <ng-container *ngIf="shouldGroupOptions">
            <ng-container *ngFor="let keys of groupByKeys">
                <span class="px-3 fw-bold pt-2 font-14 d-block">{{ keys.name }}</span>
                <ng-container *ngFor="let option of filteredList">
                    <mat-option [value]="emitEntireObjectAsValue ? option : option.name" *ngIf="option?.[keys.check]">
                        {{ option.name }}
                    </mat-option>
                </ng-container>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="!shouldGroupOptions">
            <mat-option [value]="emitEntireObjectAsValue ? option : option.name" *ngFor="let option of filteredList">
                {{ option.name }}
            </mat-option>
        </ng-container>
    </mat-autocomplete>
    <mat-error *ngIf="matFormControl.touched && matFormControl.errors">
        <mat-error *ngIf="matFormControl.errors?.required"> {{ fieldName }} is required. </mat-error>
        <mat-error *ngIf="matFormControl.errors?.elementExistsInList"> {{ fieldName }} select from list. </mat-error>
    </mat-error>
    <button
        mat-icon-button
        matSuffix
        class="cursor-pointer icon-btn-md"
        color="primary"
        (click)="clearValue()"
        *ngIf="matFormControl?.value && !disabledField"
    >
        <mat-icon class="mat-icon-20 text-dark">close</mat-icon>
    </button>
</mat-form-field>
